t$w_geocode<-as.character(t$w_geocode)
t$h_geocode<-as.character(t$h_geocode)
t$w_geocode[which(length(t$w_geocode) == 14)]<-paste0("0",t$w_geocode[which(length(t$w_geocode) == 14)])
t$h_geocode[which(length(t$h_geocode) == 14)]<-paste0("0",t$h_geocode[which(length(t$h_geocode) == 14)])
t = read.csv("wa_od_main_JT00_2015.csv")
t$w_geocode<-as.character(t$w_geocode)
t$h_geocode<-as.character(t$h_geocode)
t$w_geocode[which(length(t$w_geocode) == 14)]<-paste0("0",t$w_geocode[which(length(t$w_geocode) == 14)])
t$h_geocode[which(length(t$h_geocode) == 14)]<-paste0("0",t$h_geocode[which(length(t$h_geocode) == 14)])
t$wt<-substr(t$w_geocode,1,11)
t$ht<-substr(t$h_geocode,1,11)
wtutract=aggregate(. ~ wt + ht,data=t[,c(11,14,15)],FUN=sum)
t$w_geocode<-as.character(t$w_geocode)
t$h_geocode<-as.character(t$h_geocode)
t$w_geocode[which(length(t$w_geocode) == 14)]<-paste0("0",t$w_geocode[which(length(t$w_geocode) == 14)])
t$h_geocode[which(length(t$h_geocode) == 14)]<-paste0("0",t$h_geocode[which(length(t$h_geocode) == 14)])
t$wt<-substr(t$w_geocode,1,11)
t$ht<-substr(t$h_geocode,1,11)
wtutract=aggregate(. ~ wt + ht,data=t[,c(11,14,15)],FUN=sum)
View(wtutract)
View(t)
t$ht<-substr(t$h_geocode,1,11)
t$ht
wtutract=aggregate(. ~ wt + ht,data=t[,c(11,14,15)],FUN=sum)
wtutract=aggregate(. ~ wt + ht,data=t[,c(11,14,15)],FUN=sum)
mantract=aggregate(. ~ wt + ht,data=t[,c(10,14,15)],FUN=sum)
total=aggregate(. ~ wt + ht, data=t[,c(3,14,15)],FUN=sum)
all=aggregate(.~ wt + ht, data=t[,c(3,10,11,14,15)],FUN=sum)
View(total)
##Importing MSA tract list and cleaning up to make merge work
msa=read.csv("WA_census_2015.csv")
View(msa)
names(msa)[1]=paste("wt")
View(msa)
View(total)
##Importing MSA tract list and cleaning up to make merge work
msa=read.csv("WA_census_2015.csv")
View(msa)
names(msa)[GEOID] <- "wt"
names(msa)
names(msa)["GEOID"] <- "wt"
names(msa)[6] <- "wt"
##Merging to cut dataset down to just Seattle MSA
wtutract2=merge(msa,wtutract,by="wt")
mantract2=merge(msa,mantract,by="wt")
totaltract2=merge(msa,total,by="wt")
allmsa=merge(msa,all,by="wt")
allmsa["WTUShare"]=allmsa$SI02/allmsa$S000
allmsa["MANShare"]=allmsa$SI01/allmsa$S000
#check for duplicate values and create file, 's', that is only w_geocode and h_geocode fields
s<-unique(t[,1:2])
nrow(s)==nrow(t)
#add count variable (for count of "sending" blocks)
s$ct<-1
#using 's', sum count variable to get number of blocks "sending" jobs to work block
r<-aggregate(. ~ w_geocode, data=s[,-2], FUN=sum)
#using original file 't', sum job variable S000 to get count of "jobs" to work block
r2<-aggregate(. ~ w_geocode, data=t[,c(1,3)], FUN=sum)
#merge two sums together by work block FIPS
r<-merge(r,r2,by="w_geocode")
#create file 's2' that has w_geocode and ht
s2<-unique(t[,c(1,15)])
#add count variable (for count of "sending" tracts)
s2$trct<-1
#using 's2', sum count variable to get number of tracts "sending" jobs to work block
s2<-aggregate(. ~ w_geocode, data=s2[,c(1,3)], FUN=sum)
r<-merge(r,s2,by="w_geocode")
#OPTIONAL: create variable that is ratio of "sending" blocks to total jobs
#OPTIONAL: create variable that is ratio of "sending" tracts to total jobs
r$blkjr<-r$ct/r$S000
r$trjr<-r$trct/r$S000
#plots
hist(r$trjr)
hist(r$blkjr)
plot(r$S000,r$ct)
plot(r$S000,r$trct)
plot(r$S000[which(r$S000<1000)],r$trct[which(r$S000<1000)])
library(reshape2)
##Issues
wtuodtract=acast(wtutract2, wt ~ ht,value.var="SI02")
wtuodtract[is.na(wtuodtract)]=0
write.table(wtuodtract,"wtuodtract.csv")
manodtract=acast(mantract2, wt ~ ht,value.var="SI01")
manodtract[is.na(manodtract)]=0
totalodtract=acast(totaltract2,wt ~ ht,value.var="S000")
totalodtract[is.na(total)]=0
write.table(manodtract,"manodtract.csv")
node=read.csv("lognodes.csv")
View(wtutract2)
View(manodtract)
node=read.csv("manodtract.csv")
node2=merge(node,wtutract2,by="wt")
node=read.csv("manodtract.csv")
node2=merge(node,wtutract2,by="wt")
node2=merge(x = node,y = wtutract2, by="wt")
node2=merge(x = node,y = wtutract2, by.x ="wt")
node=read.csv("wtuodtract.csv")
node2=merge(x = node,y = wtutract2, by.x ="wt", by.y = "")
node2=merge(x = node,y = wtutract2, by = "wt")
node2=merge(x = node,y = wtutract2, by.x = "wt")
View(allmsa)
View(t)
View(wtuodtract)
View(t)
View(manodtract)
View(allmsa)
View(mantract)
View(mantract2)
View(manodtract)
View(all)
View(r)
r<-merge(r,s2,by="w_geocode")
View(r)
##Importing MSA tract list and cleaning up to make merge work
msa=read.csv("kcTract10.csv")
View(msa)
names(msa)[5] <- "wt"
##Merging to cut dataset down to just Seattle MSA
wtutract2=merge(msa,wtutract,by="wt")
mantract2=merge(msa,mantract,by="wt")
totaltract2=merge(msa,total,by="wt")
allmsa=merge(msa,all,by="wt")
allmsa["WTUShare"]=allmsa$SI02/allmsa$S000
allmsa["MANShare"]=allmsa$SI01/allmsa$S000
#check for duplicate values and create file, 's', that is only w_geocode and h_geocode fields
s<-unique(t[,1:2])
nrow(s)==nrow(t)
#add count variable (for count of "sending" blocks)
s$ct<-1
#using 's', sum count variable to get number of blocks "sending" jobs to work block
r<-aggregate(. ~ w_geocode, data=s[,-2], FUN=sum)
#using original file 't', sum job variable S000 to get count of "jobs" to work block
r2<-aggregate(. ~ w_geocode, data=t[,c(1,3)], FUN=sum)
#merge two sums together by work block FIPS
r<-merge(r,r2,by="w_geocode")
#create file 's2' that has w_geocode and ht
s2<-unique(t[,c(1,15)])
#add count variable (for count of "sending" tracts)
s2$trct<-1
#using 's2', sum count variable to get number of tracts "sending" jobs to work block
s2<-aggregate(. ~ w_geocode, data=s2[,c(1,3)], FUN=sum)
r<-merge(r,s2,by="w_geocode")
#OPTIONAL: create variable that is ratio of "sending" blocks to total jobs
#OPTIONAL: create variable that is ratio of "sending" tracts to total jobs
r$blkjr<-r$ct/r$S000
r$trjr<-r$trct/r$S000
#plots
hist(r$trjr)
hist(r$blkjr)
plot(r$S000,r$ct)
plot(r$S000,r$trct)
plot(r$S000[which(r$S000<1000)],r$trct[which(r$S000<1000)])
library(reshape2)
##Issues
wtuodtract=acast(wtutract2, wt ~ ht,value.var="SI02")
wtuodtract[is.na(wtuodtract)]=0
write.table(wtuodtract,"wtuodtract.csv")
manodtract=acast(mantract2, wt ~ ht,value.var="SI01")
manodtract[is.na(manodtract)]=0
totalodtract=acast(totaltract2,wt ~ ht,value.var="S000")
totalodtract[is.na(total)]=0
write.table(manodtract,"manodtract.csv")
View(wtuodtract)
View(wtuodtract)
t = read.csv("wa_od_main_JT00_2015.csv")
t = read.csv("wa_od_main_JT00_2015.csv")
t$w_geocode<-as.character(t$w_geocode)
t$h_geocode<-as.character(t$h_geocode)
t$h_geocode[which(length(t$h_geocode) == 14)]<-paste0("0",t$h_geocode[which(length(t$h_geocode) == 14)])
t = read.csv("wa_od_main_JT00_2015.csv")
t = read.csv("wa_od_main_JT00_2015.csv")
t$w_geocode<-as.character(t$w_geocode)
t$h_geocode<-as.character(t$h_geocode)
View(t)
t = read.csv("wa_od_main_JT00_2015.csv")
View(t)
t$w_geocode<-as.character(t$w_geocode)
View(t)
t$w_geocode<-as.character(t$w_geocode)
t$h_geocode<-as.character(t$h_geocode)
View(t)
t$w_geocode[which(length(t$w_geocode) == 14)]<-paste0("0",t$w_geocode[which(length(t$w_geocode) == 14)])
t$h_geocode[which(length(t$h_geocode) == 14)]<-paste0("0",t$h_geocode[which(length(t$h_geocode) == 14)])
t$wt<-substr(t$w_geocode,1,11)
t$ht<-substr(t$h_geocode,1,11)
wtutract=aggregate(. ~ wt + ht,data=t[,c(11,14,15)],FUN=sum)
mantract=aggregate(. ~ wt + ht,data=t[,c(10,14,15)],FUN=sum)
total=aggregate(. ~ wt + ht, data=t[,c(3,14,15)],FUN=sum)
View(total)
